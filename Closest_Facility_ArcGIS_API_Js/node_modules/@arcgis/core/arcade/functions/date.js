/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.21/esri/copyright.txt for details.
*/
import{p as e,w as n,t,C as r,d as s,D as u,f as o,E as a,F as c}from"../../chunks/languageUtils.js";import{getLocale as i}from"../../intl/locale.js";import{DateTime as l}from"luxon";function f(e){const n=new Date(e.getTime()),t=n.getFullYear(),r=new Date(0);r.setFullYear(t+1,0,4),r.setHours(0,0,0,0);const s=d(r),u=new Date(0);u.setFullYear(t,0,4),u.setHours(0,0,0,0);const o=d(u);return n.getTime()>=s.getTime()?t+1:n.getTime()>=o.getTime()?t:t-1}function d(e){const n=1,t=new Date(e.getTime()),r=t.getDay(),s=(r<n?7:0)+r-n;return t.setDate(t.getDate()-s),t.setHours(0,0,0,0),t}function g(e){const n=f(e),t=new Date(0);t.setFullYear(n,0,4),t.setHours(0,0,0,0);return d(t)}function m(e,n,t){return e+(h(t)?D:N)[n]}function h(e){return e%4==0&&(e%100!=0||e%400==0)}const N=[0,31,59,90,120,151,181,212,243,273,304,334],D=[0,31,60,91,121,152,182,213,244,274,305,335];function w(e){return null===e?e:isNaN(e.getTime())?null:e}function y(h,N){h.today=function(n,t){return N(n,t,(function(n,t,r){e(r,0,0);const s=new Date;return s.setHours(0,0,0,0),s}))},h.now=function(n,t){return N(n,t,(function(n,t,r){e(r,0,0);return new Date}))},h.timestamp=function(n,t){return N(n,t,(function(n,t,r){e(r,0,0);let s=new Date;return s=new Date(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate(),s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds(),s.getUTCMilliseconds()),s}))},h.toutc=function(t,r){return N(t,r,(function(t,r,s){e(s,1,1);const u=n(s[0]);return null===u?null:new Date(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate(),u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds())}))},h.tolocal=function(t,r){return N(t,r,(function(t,r,s){e(s,1,1);const u=n(s[0]);return null===u?null:l.utc(u.getFullYear(),u.getMonth()+1,u.getDate(),u.getHours(),u.getMinutes(),u.getSeconds(),u.getMilliseconds()).toJSDate()}))},h.day=function(t,r){return N(t,r,(function(t,r,s){e(s,1,1);const u=n(s[0]);return null===u?NaN:u.getDate()}))},h.month=function(t,r){return N(t,r,(function(t,r,s){e(s,1,1);const u=n(s[0]);return null===u?NaN:u.getMonth()}))},h.year=function(t,r){return N(t,r,(function(t,r,s){e(s,1,1);const u=n(s[0]);return null===u?NaN:u.getFullYear()}))},h.hour=function(t,r){return N(t,r,(function(t,r,s){e(s,1,1);const u=n(s[0]);return null===u?NaN:u.getHours()}))},h.second=function(t,r){return N(t,r,(function(t,r,s){e(s,1,1);const u=n(s[0]);return null===u?NaN:u.getSeconds()}))},h.millisecond=function(t,r){return N(t,r,(function(t,r,s){e(s,1,1);const u=n(s[0]);return null===u?NaN:u.getMilliseconds()}))},h.minute=function(t,r){return N(t,r,(function(t,r,s){e(s,1,1);const u=n(s[0]);return null===u?NaN:u.getMinutes()}))},h.week=function(s,u){return N(s,u,(function(s,u,o){e(o,1,2);const a=n(o[0]);if(null===a)return NaN;const c=t(r(o[1],0));if(c<0||c>6)throw new Error("Invalid Parameter");const i=a.getDate(),l=a.getMonth(),f=a.getFullYear(),d=a.getDay(),g=m(i,l,f)-1,h=Math.floor(g/7);return d-c+(d-c<0?7:0)<g-7*h?h+1:h}))},h.weekday=function(t,r){return N(t,r,(function(t,r,s){e(s,1,1);const u=n(s[0]);return null===u?NaN:u.getDay()}))},h.isoweekday=function(t,r){return N(t,r,(function(t,r,s){e(s,1,1);const u=n(s[0]);if(null===u)return NaN;let o=u.getDay();return 0===o&&(o=7),o}))},h.isomonth=function(t,r){return N(t,r,(function(t,r,s){e(s,1,1);const u=n(s[0]);return null===u?NaN:u.getMonth()+1}))},h.isoweek=function(t,r){return N(t,r,(function(t,r,s){e(s,1,1);const u=n(s[0]);if(null===u)return NaN;const o=d(u).getTime()-g(u).getTime();return Math.round(o/6048e5)+1}))},h.isoyear=function(t,r){return N(t,r,(function(t,r,s){e(s,1,1);const u=n(s[0]);return null===u?NaN:f(u)}))},h.date=function(r,a){return N(r,a,(function(r,a,c){if(e(c,0,7),3===c.length)return w(new Date(t(c[0]),t(c[1]),t(c[2]),0,0,0,0));if(4===c.length)return w(new Date(t(c[0]),t(c[1]),t(c[2]),t(c[3]),0,0,0));if(5===c.length)return w(new Date(t(c[0]),t(c[1]),t(c[2]),t(c[3]),t(c[4]),0,0));if(6===c.length)return w(new Date(t(c[0]),t(c[1]),t(c[2]),t(c[3]),t(c[4]),t(c[5]),0));if(7===c.length)return w(new Date(t(c[0]),t(c[1]),t(c[2]),t(c[3]),t(c[4]),t(c[5]),t(c[6])));if(2===c.length){let e,n=s(c[1]);return""===n?null:(n=u(n),e="X"===n?l.fromSeconds(t(c[0])):"x"===n?l.fromMillis(t(c[0])):l.fromFormat(s(c[0]),n,{locale:i(),numberingSystem:"latn"}),e.isValid?e.toJSDate():null)}if(1===c.length){if(o(c[0])){if(""===c[0].replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))return null;if(!0===/^[0-9][0-9][0-9][0-9]$/.test(c[0]))return n(c[0]+"-01-01")}const e=t(c[0]);if(!1===isNaN(e))return w(new Date(e));return n(c[0])}return 0===c.length?new Date:void 0}))},h.datediff=function(n,t){return N(n,t,(function(n,t,r){e(r,2,3);const u=a(r[0]),o=a(r[1]);if(null===u||null===o)return NaN;switch(s(r[2]).toLowerCase()){case"days":case"day":case"d":return u.diff(o,"days").days;case"months":case"month":return u.diff(o,"months").months;case"minutes":case"minute":case"m":return"M"===r[2]?u.diff(o,"months").months:u.diff(o,"minutes").minutes;case"seconds":case"second":case"s":return u.diff(o,"seconds").seconds;case"milliseconds":case"millisecond":case"ms":return u.diff(o).milliseconds;case"hours":case"hour":case"h":return u.diff(o,"hours").hours;case"years":case"year":case"y":return u.diff(o,"years").years;default:return u.diff(o).milliseconds}}))},h.dateadd=function(n,r){return N(n,r,(function(n,r,u){e(u,2,3);const o=a(u[0]);if(null===o)return null;let i=t(u[1]);if(isNaN(i))return o.toJSDate();let l="milliseconds";switch(s(u[2]).toLowerCase()){case"days":case"day":case"d":l="days",i=c(i);break;case"months":case"month":l="months",i=c(i);break;case"minutes":case"minute":case"m":l="M"===u[2]?"months":"minutes";break;case"seconds":case"second":case"s":l="seconds";break;case"milliseconds":case"millisecond":case"ms":l="milliseconds";break;case"hours":case"hour":case"h":l="hours";break;case"years":case"year":case"y":l="years"}return o.plus({[l]:i}).toJSDate()}))}}export{y as registerFunctions};
