/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.21/esri/copyright.txt for details.
*/
import{nullifyNonnullableForDispose as t}from"./maybe.js";import s from"./nextTick.js";class i{constructor(t){this.allocator=t,this.items=[],this.itemsPtr=0,this.tickHandle=s.before((()=>this.reset())),this.grow()}destroy(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=t(this.tickHandle)),this.items=t(this.items)}get(){return 0===this.itemsPtr&&s((()=>{})),this.itemsPtr===this.items.length&&this.grow(),this.items[this.itemsPtr++]}reset(){const t=Math.min(3*Math.max(8,this.itemsPtr),this.itemsPtr+3*e);this.items.length=Math.min(t,this.items.length),this.itemsPtr=0}grow(){for(let t=0;t<Math.max(8,Math.min(this.items.length,e));t++)this.items.push(this.allocator())}}const e=1024;export{i as ObjectStack,i as default};
