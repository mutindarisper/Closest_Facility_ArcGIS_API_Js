/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.21/esri/copyright.txt for details.
*/
import{p as s,s as i,h as o,w as n,x as r,a as t,i as a,b as e}from"../../../../chunks/vec2.js";import{b as c,G as b,a as g,f,e as u,c as p,n as m,d as I,l as d}from"../../../../chunks/vec3.js";import{f as N,Z as j}from"../../../../chunks/vec3f64.js";import{a as x,u as E}from"../../../../chunks/boundedPlane.js";import{sv2d as T,sv3d as V}from"../../../../geometry/support/vectorStacks.js";import{MoveVertex as h}from"../operations/MoveVertex.js";import{RotateVertex as v}from"../operations/RotateVertex.js";import{ScaleVertex as R}from"../operations/ScaleVertex.js";import{UpdateVertices as k}from"../operations/UpdateVertices.js";function l(s,i){return F(s,i,!1)}function C(s,i){return F(s,i,!0)}function F(s,i,o){if(s instanceof k){if(s.operation instanceof h)return S(s.operation,i,o),!0;if(s.operation instanceof v)return Y(s.operation,i,o),!0;if(s.operation instanceof R)return _(s.operation,i,o),!0}return!1}function S(s,i,o=!1){const n=o?-1:1,r=N(n*s.dx,n*s.dy,n*s.dz);c(i.origin,i.origin,r)}function Y(s,i,o=!1){const n=o?-s.angle:s.angle;b(i.basis1,i.basis1,j,n),b(i.basis2,i.basis2,j,n)}function _(i,o,n=!1){const r=n?1/i.factor1:i.factor1,t=n?1/i.factor2:i.factor2;g(o.basis1,o.basis1,r),g(o.basis2,o.basis2,t),s(o.origin,o.origin,i.origin,i.axis1,r),s(o.origin,o.origin,i.origin,i.axis2,t)}function G(s,c,b,g){g||(g=x());const f=i(T.get(),s[1],-s[0]),u=i(T.get(),Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),p=i(T.get(),Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),m=T.get();c.components.forEach((t=>t.vertices.forEach((t=>{const a=t.pos;i(m,o(s,a),o(f,a)),n(u,u,m),r(p,p,m)}))));const I=1e-6,d=i(T.get(),p[0]-u[0]<I?b/2:0,p[1]-u[1]<I?b/2:0);return t(u,u,d),a(p,p,d),e(g.basis1,s,(p[0]-u[0])/2),e(g.basis2,f,(p[1]-u[1])/2),i(g.origin,u[0]*s[0]+u[1]*f[0],u[0]*s[1]+u[1]*f[1]),a(g.origin,g.origin,g.basis1),a(g.origin,g.origin,g.basis2),g}function P(s,i,o,n=0,r){r||(r=x()),i.toRenderCoords(s.origin,o,r.origin);const t=V.get();c(t,s.origin,s.basis1),c(t,t,s.basis2),i.toRenderCoords(t,o,t);const a=V.get();c(a,s.origin,s.basis1),f(a,a,s.basis2),i.toRenderCoords(a,o,a);const e=V.get();f(e,s.origin,s.basis1),f(e,e,s.basis2),i.toRenderCoords(e,o,e);const b=V.get();f(b,s.origin,s.basis1),c(b,b,s.basis2),i.toRenderCoords(b,o,b);const N=u(V.get(),t,a,.5);f(N,N,r.origin);const j=u(V.get(),e,b,.5);f(j,r.origin,j),u(r.basis1,N,j,.5);const T=u(V.get(),b,t,.5);f(T,T,r.origin);const h=u(V.get(),a,e,.5);f(h,r.origin,h),u(r.basis2,T,h,.5);const v=p(V.get(),r.basis1,r.basis2),R=p(v,v,r.basis1);return m(R,R),g(r.basis2,R,I(r.basis2,R)),g(r.basis1,r.basis1,1+n/d(r.basis1)),g(r.basis2,r.basis2,1+n/d(r.basis2)),E(r),r}export{l as apply,G as calculateOrientedBounds,P as mapPlaneToRenderPlane,C as unapply};
