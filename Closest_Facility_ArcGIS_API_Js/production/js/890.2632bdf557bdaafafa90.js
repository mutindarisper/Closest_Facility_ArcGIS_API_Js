"use strict";(self.webpackChunkarcgis_rm=self.webpackChunkarcgis_rm||[]).push([[890],{18486:(e,t,i)=>{i.d(t,{vF:()=>S,_D:()=>x,Qp:()=>P,P_:()=>C,Hq:()=>R,zD:()=>d,tB:()=>w,nF:()=>g,VO:()=>m,kZ:()=>k,kr:()=>I}),i(91957);var s=i(70375),r=i(61681),a=i(17321),n=i(27199),o=i(39536),l=i(91772),h=i(53446);const c=5e-4,u=function(e,t){const i=(e.isWGS84||e.isWebMercator)&&(t.isWGS84||t.isWebMercator);return!(e.equals(t)||i)},p={3395:20037508.342789244,3410:17334193.943686873,3832:3339584.723798206,3857:20037508.342788905,3975:17367530.445161372,4087:20037508.342789244,4088:20015108.787169147,6933:17367530.445161372,8858:7396237.374497803,8859:2465412.4581659334,32662:20037508.342789244,53001:20015086.79602057,53002:10007543.39801029,53003:20015086.79602057,53004:20015086.79602057,53016:14152803.599503474,53017:17333573.624304302,53025:7276828.3848298555,53031:10384677.558821043,53034:20015086.79602057,53036:7389443.187332862,53037:2463147.729110953,53079:20015114.352186374,53080:20015114.352186374,54001:20037508.342789244,54002:10018754.171394624,54003:20037508.342789244,54004:20037508.342789244,54016:14168658.027268292,54017:17367530.44516137,54025:7311399.09166516,54031:10396310.810074743,54034:20037508.342789244,54050:808820.9223376509,54053:1920897.3915568967,54079:20037508.342789244,54080:20037508.342789244,54100:20037508.342789244,54101:20037508.342789244,102038:4297258.582585486,102299:5013965.117483125};async function d(){if((0,n.kR)()||!(0,n.Gb)())return null;await(0,n.zD)()}function x(e,t,i){if(!u(e.spatialReference,t))return null;if(!(0,n.kR)())throw new s.Z("rasterprojectionhelper-projectResolution","projection engine is not loaded");return i?(0,n.rS)(t,e.spatialReference,e):(0,n.rS)(e.spatialReference,t,e)}function m(e,t,i,a=null){if(e.spatialReference.equals(t))return e;const h=u(e.spatialReference,t);if(h&&!(0,n.kR)())throw new s.Z("rasterprojectionhelper-projectResolution","projection engine is not loaded");const c=i.center,p=new l.Z({xmin:c.x-e.x/2,xmax:c.x+e.x/2,ymin:c.y-e.y/2,ymax:c.y+e.y/2,spatialReference:e.spatialReference}),d=h?(0,n.iV)(p,t,a):(0,o.iV)(p,t);return(0,r.Wi)(d)?null:{x:d.xmax-d.xmin,y:d.ymax-d.ymin}}function f(e,t=.01){return(0,a.c9)(e)?t/(0,a.c9)(e):0}function g(e,t,i=null,a=!0){const l=e.spatialReference;if(l.equals(t))return e;let h=(0,o.iV)(e,t);if((0,r.Wi)(h)){if(!(0,n.kR)())throw new s.Z("rasterprojectionhelper-projectResolution","projection engine is not loaded");h=(0,n.iV)(e,t,i)}if(a&&t.isGeographic){const[t,i]=b(l,!0),s=f(l);s&&null!=t&&null!=i&&(Math.abs(e.x-t)<s&&Math.abs(180-h.x)<c?h.x-=360:Math.abs(e.x-i)<s&&Math.abs(180+h.x)<c&&(h.x+=360))}return h}function y(e){const t=_(e[0].spatialReference);if(e.length<2||!(0,r.pC)(t))return e[0];let{xmin:i,xmax:s,ymin:a,ymax:n}=e[0];for(let i=1;i<e.length;i++){const r=e[i];s=r.xmax+t*i,a=Math.min(a,r.ymin),n=Math.max(n,r.ymax)}return new l.Z({xmin:i,xmax:s,ymin:a,ymax:n,spatialReference:e[0].spatialReference})}function w(e,t,i=null,s=!0){if(e.spatialReference.equals(t))return e;const a=R(e),n=_(e.spatialReference,!0);return(0,r.pC)(n)&&0!==a?y(e.clone().normalize().map((e=>v(e,t,i,s)))):v(e,t,i,s)}function v(e,t,i=null,a=!0){const l=e.spatialReference;if(l.equals(t))return e;if(u(l,t)&&!(0,n.kR)())throw new s.Z("rasterprojectionhelper-projectExtent","projection engine is not loaded");let p=(0,o.iV)(e,t);(0,r.Wi)(p)&&(p=(0,n.iV)(e,t,i));let[d,x]=b(l,!0);if(p&&a&&l.isWebMercator&&t.isGeographic&&null!=d&&null!=x){const s=.001,r=1e3;if(Math.abs(e.xmin-d)<s&&Math.abs(x-e.xmax)>r&&Math.abs(180-p.xmax)<c){p.xmin=-180;const s=[];s.push(new h.Z(e.xmax,e.ymin,l)),s.push(new h.Z(e.xmax,(e.ymin+e.ymax)/2,l)),s.push(new h.Z(e.xmax,e.ymax,l));const r=s.map((e=>g(e,t,i))).filter((e=>!isNaN(null==e?void 0:e.x))).map((e=>e.x));p.xmax=Math.max.apply(null,r)}if(Math.abs(e.xmax-x)<s&&Math.abs(d-e.xmin)>r&&Math.abs(180+p.xmin)<c){p.xmax=180;const s=[];s.push(new h.Z(e.xmin,e.ymin,l)),s.push(new h.Z(e.xmin,(e.ymin+e.ymax)/2,l)),s.push(new h.Z(e.xmin,e.ymax,l));const r=s.map((e=>g(e,t,i))).filter((e=>!isNaN(null==e?void 0:e.x))).map((e=>e.x));p.xmin=Math.min.apply(null,r)}}[d,x]=b(t,!0);const m=f(t);return m&&null!=d&&null!=x&&(Math.abs(p.xmin-d)<m&&(p.xmin=d),Math.abs(p.xmax-x)<m&&(p.xmax=x)),p}function _(e,t=!1){const i=t?20037508.342787:20037508.342788905;return e.isWebMercator?2*i:e.wkid&&e.isGeographic?360:2*p[e.wkid]||null}function b(e,t=!1){const i=[],s=_(e,t);return(0,r.pC)(s)&&(i.push(-s/2),i.push(s/2)),i}function M(e,t,i,s){let r=(e-t)/i;return r-Math.floor(r)!=0?r=Math.floor(r):s&&(r-=1),r}function R(e,t=!1){const i=_(e.spatialReference);if(!(0,r.pC)(i))return 0;const s=t?0:-i/2;return M(e.xmax,s,i,!0)-M(e.xmin,s,i,!1)}function C(e){const t=e.storageInfo.origin.x,i=_(e.spatialReference,!0);if(!(0,r.pC)(i))return{originX:t,halfWorldWidth:null,pyramidsInfo:null};const s=i/2,{nativePixelSize:a,storageInfo:n,extent:o}=e,{maximumPyramidLevel:l,blockWidth:h,pyramidScalingFactor:c}=n;let u=a.x;const p=[],d=(0,r.pC)(e.transform)&&"gcs-shift"===e.transform.type,x=t+s,m=d?i-t:s-t;for(let e=0;e<=l;e++){const e=(o.xmax-t)/u/h,s=e-Math.floor(e)==0?e:Math.ceil(e),r=(i/2-t)/u/h,a=r-Math.floor(r)==0?r:Math.ceil(r),n=Math.floor(x/u/h),l=Math.round(x/u)%h,d=(h-Math.round(m/u)%h)%h;p.push({resolutionX:u,blockWidth:h,datsetColumnCount:s,worldColumnCountFromOrigin:a,leftMargin:l,rightPadding:d,originColumnOffset:n}),u*=c}return{originX:t,halfWorldWidth:s,pyramidsInfo:p,hasGCSSShiftTransform:d}}function P(e,t,i,a=null,o=null,l=!1,c=[32,32]){if(u(e.spatialReference,t.spatialReference)&&!(0,n.kR)())throw new s.Z("rasterprojectionhelper-projectResolution","projection engine is not loaded");if(!(e&&t&&i))return null;const{xmin:p,ymin:d,xmax:x,ymax:m}=e,f=e.spatialReference,y=t.spatialReference,w=_(y);l=l||"gcs-shift"===(null==o?void 0:o.type);const v={x:c[0]*i.x,y:c[1]*i.y},b={cols:Math.ceil((x-p)/v.x-.1/c[0])+1,rows:Math.ceil((m-d)/v.y-.1/c[1])+1},M=v.x,R=v.y,C=[];let P,k=!1;for(let e=0;e<b.cols;e++){const i=[];for(let s=0;s<b.rows;s++){let n=g(new h.Z({x:p+M*e,y:m-R*s,spatialReference:f}),y,a);o&&(n=o.inverseTransform(n)),i.push(n),e>0&&l&&n&&P[s]&&(0,r.pC)(w)&&n.x<P[s].x&&(n.x+=w),n?(C.push((n.x-t.xmin)/(t.xmax-t.xmin)),C.push((t.ymax-n.y)/(t.ymax-t.ymin))):(C.push(NaN),C.push(NaN),k=!0)}P=i}const I=function(e,t){const i=(e[0]+e[4]+e[4*t.cols]+e[4*t.cols+4])/4,s=(e[1]+e[5]+e[4*t.rows+1]+e[4*t.rows+5])/4;return[Math.abs(i-e[2*t.rows+2]),Math.abs(s-e[2*t.rows+3])]}(C,b),S=new Float32Array((b.cols-1)*(b.rows-1)*2*6),V=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),E=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let e=0;e<b.cols-1;e++){for(let t=0;t<b.rows-1;t++){let i=e*b.rows*2+2*t;const s=C[i],r=C[i+1],a=C[i+2],n=C[i+3];i+=2*b.rows;const o=C[i],l=C[i+1],h=C[i+2],c=C[i+3];let u=0,p=12*(t*(b.cols-1)+e);for(let e=0;e<3;e++)S[p++]=V[u++]*s+V[u++]*a+V[u++]*h;u=0;for(let e=0;e<3;e++)S[p++]=V[u++]*r+V[u++]*n+V[u++]*c;u=0;for(let e=0;e<3;e++)S[p++]=E[u++]*s+E[u++]*o+E[u++]*h;u=0;for(let e=0;e<3;e++)S[p++]=E[u++]*r+E[u++]*l+E[u++]*c}if(k)for(let e=0;e<S.length;e++)isNaN(S[e])&&(S[e]=-1)}return{offsets:C,error:I,coefficients:S,spacing:c,size:[b.cols-1,b.rows-1]}}function k(e){const t=e.clone().normalize();return 1===t.length?t[0]:y(t)}function I(e,t,i){const{storageInfo:s,pixelSize:a}=t;let n,o=!1;const{pyramidResolutions:l}=s;if((0,r.pC)(l)&&l.length){const s=(e.x+e.y)/2,r=l[l.length-1],c=(r.x+r.y)/2,u=(a.x+a.y)/2;if(s<=u)n=0;else if(s>=c)n=l.length,o=s/c>8;else{let e,t=u;for(let r=1;r<=l.length;r++){if(e=(l[r-1].x+l[r-1].y)/2,s<=e){s===e?n=r:"down"===i?(n=r-1,o=s/t>8):n="up"===i||s-t>e-s||s/t>2?r:r-1;break}t=e}}const p=0===n?a:l[n-1];return{pyramidLevel:n,pyramidResolution:new h.Z({x:p.x,y:p.y,spatialReference:t.spatialReference}),excessiveReading:o}}const c=Math.log(e.x/a.x)/Math.LN2,u=Math.log(e.y/a.y)/Math.LN2,p=t.storageInfo.maximumPyramidLevel||0;n="down"===i?Math.floor(Math.min(c,u)):"up"===i?Math.ceil(Math.max(c,u)):Math.round((c+u)/2),n<0?n=0:n>p&&(o=n>p+3,n=p);const d=2**n;return{pyramidLevel:n,pyramidResolution:new h.Z({x:d*t.nativePixelSize.x,y:d*t.nativePixelSize.y,spatialReference:t.spatialReference}),excessiveReading:o}}function S(e,t,i=512,s=!0){const{extent:r,spatialReference:n,pixelSize:o}=e,l=m(new h.Z({x:o.x,y:o.y,spatialReference:n}),t,r);if(null==l)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const c=(l.x+l.y)/2,u=(0,a.c9)(t),p=c*u*96*39.37,d=t.isGeographic?256/i*295828763.7958547:256/i*591657527.591555;let x="vector-magdir"===e.dataType||"vector-uv"===e.dataType;const f=w(r,t);x||s&&(t.isGeographic||t.isWebMercator)&&(x=f.xmin*f.xmax<0);let g,y=p;const v=1.001;if(x){y=d;const e=t.isGeographic?1341104507446289e-21:.29858214164761665,i=e*(96*u*39.37),s=t.isGeographic?4326:3857;g=m(new h.Z({x:e,y:e,spatialReference:{wkid:s}}),n,f),g.x*=y/i,g.y*=y/i}else{g={x:o.x,y:o.y};const t=Math.ceil(Math.log(Math.min(e.width,e.height)/32)/Math.LN2);let i=0;for(;y<d*(v/2)&&i<t;)i++,y*=2,g.x*=2,g.y*=2;Math.max(y,d)/Math.min(y,d)<=v&&(y=d)}const _=[y],b=[{x:g.x,y:g.y}],M=Math.min(70.5310735,p)/v;for(;y>=M;)y/=2,g.x/=2,g.y/=2,_.push(y),b.push({x:g.x,y:g.y});return{projectedPixelSize:l,scales:_,srcResolutions:b,isCustomTilingScheme:!x}}},7928:(e,t,i)=>{i.d(t,{KC:()=>x,QI:()=>m,wF:()=>k,K:()=>P,Yx:()=>c,nb:()=>I,BH:()=>f,NL:()=>h,Tg:()=>p});var s=i(25709),r=i(61681),a=i(34780),n=i(31329);const o=new Map;o.set("meter-per-second",1),o.set("kilometer-per-hour",.277778),o.set("knots",.514444),o.set("feet-per-second",.3048),o.set("mile-per-hour",.44704);const l=180/Math.PI,h=new s.Xn({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"});function c(e,t){return o.get(e)/o.get(t)||1}function u(e){return(450-e)%360}function p(e,t="geographic"){const[i,s]=e,r=Math.sqrt(i*i+s*s);let a=Math.atan2(s,i)*l;return a=(360+a)%360,"geographic"===t&&(a=u(a)),[r,a]}function d(e,t="geographic"){let i=e[1];"geographic"===t&&(i=u(i)),i%=360;const s=e[0];return[s*Math.cos(i/l),s*Math.sin(i/l)]}function x(e,t,i="geographic",s=1){if(!(0,n.nk)(e))return e;const{pixels:r,width:o,height:l}=e,h=o*l,c=r[0],u=r[1],x=a.Z.createEmptyBand(e.pixelType,h),m=a.Z.createEmptyBand(e.pixelType,h);let f=0;for(let e=0;e<l;e++)for(let e=0;e<o;e++)"vector-uv"===t?([x[f],m[f]]=p([c[f],u[f]],i),x[f]*=s):([x[f],m[f]]=d([c[f],u[f]],i),x[f]*=s,m[f]*=s),f++;const g=new a.Z({pixelType:e.pixelType,width:e.width,height:e.height,mask:e.mask,validPixelCount:e.validPixelCount,maskIsAlpha:e.maskIsAlpha,pixels:[x,m]});return g.updateStatistics(),g}function m(e,t,i=1){if(1===i||!(0,n.nk)(e))return e;const s=e.clone(),{pixels:r,width:a,height:o}=s,l=r[0],h=r[1];let c=0;for(let e=0;e<o;e++)for(let e=0;e<a;e++)"vector-uv"===t?(l[c]*=i,h[c]*=i):l[c]*=i,c++;return s.updateStatistics(),s}function f(e,t,i,s,a){if(!(0,r.pC)(a)||!a.spatialReference.equals(e.spatialReference))return{extent:e,width:t,height:i,resolution:e.width/t};const n=a.xmin,o=a.ymax;s=Math.max(s||0,30);const l=Math.ceil(t*(1/s)),h=Math.ceil(i*(1/s)),c=((e.xmax-e.xmin)/l+(e.ymax-e.ymin)/h)/2;return e.xmin=n+Math.floor((e.xmin-n)/c)*c,e.xmax=n+Math.ceil((e.xmax-n)/c)*c,e.ymin=o+Math.floor((e.ymin-o)/c)*c,e.ymax=o+Math.ceil((e.ymax-o)/c)*c,{extent:e,width:Math.round(e.width/c),height:Math.round(e.height/c),resolution:c}}const g=function(e=0,t=0,i=Math.PI,s=!0){s&&(i=(2*Math.PI-i)%(2*Math.PI));const r=s?-1:1,a=13*r,n=-7*r,o=-2*r,l=-16*r,h=29,[c,u]=w(0,t+a,i,h),[p,d]=w(e-5.5,t+n,i,h),[x,m]=w(e+5.5,t+n,i,h),[f,g]=w(e-1.5,t+o,i,h),[y,v]=w(e+1.5,t+o,i,h),[_,b]=w(e-1.5,t+l,i,h),[M,R]=w(e+1.5,t+l,i,h);return[c,u,p,d,f,g,y,v,x,m,_,b,M,R]}(0,0,0);function y(e=0,t=Math.PI,i=!0){i&&(t=(2*Math.PI-t)%(2*Math.PI));const s=i?-1:1,r=5*s,a=20*s,n=25*s,o=45,l=2*s;let[h,c]=[5,0-a],[u,p]=[h+2,c],[d,x]=[u-0,p+l],[m,f]=[-5,0-n],[g,y]=[m+0,f-l],v=Math.ceil(e/5),_=Math.floor(v/10);v-=8*_;const b=[],M=[];for(let e=0;e<v/2;e++,_--){_<=0&&v%2==1&&e===(v-1)/2&&(m=0,g=m+0,f=(f+c)/2,y=f-l);const[i,s]=w(m,f,t,o);if(_>0){const[e,r]=w(u,f,t,o),[a,n]=w(h,c,t,o);b.push(e),b.push(r),b.push(i),b.push(s),b.push(a),b.push(n)}else{const[e,r]=w(u,p,t,o),[a,n]=w(d,x,t,o),[l,h]=w(g,y,t,o);M.push(i),M.push(s),M.push(l),M.push(h),M.push(a),M.push(n),M.push(e),M.push(r)}f+=r,c+=r,p+=r,x+=r,y+=r}const[R,C]=w(5,0+a,t,o),[P,k]=w(7,0+a,t,o),[I,S]=w(5,0-n,t,o),[V,E]=w(7,0-n,t,o);return{pennants:b,barbs:M,shaft:[R,C,P,k,I,S,V,E]}}function w(e,t,i,s=1){const r=Math.sqrt(e*e+t*t)/s,a=(2*Math.PI+Math.atan2(t,e))%(2*Math.PI);return[r,(2*Math.PI+a-i)%(2*Math.PI)]}const v=[0,1,3,6,10,16,21,27,33,40,47,55,63],_=[0,.5,1,1.5,2],b=[0,.25,.5,1,1.5,2,2.5,3,3.5,4];function M(e,t,i,s){const r=c(s||"knots",i);let a;for(a=1;a<t.length;a++)if(a===t.length-1){if(e<t[a]*r)break}else if(e<=t[a]*r)break;return Math.min(a-1,t.length-2)}function R(e,t,i,s,r){let a=0;switch(t){case"beaufort_kn":a=M(e,v,"knots",i);break;case"beaufort_km":a=M(e,v,"kilometer-per-hour",i);break;case"beaufort_ft":a=M(e,v,"feet-per-second",i);break;case"beaufort_m":a=M(e,v,"meter-per-second",i);break;case"classified_arrow":a=M(e,r,s,i);break;case"ocean_current_m":a=M(e,_,"meter-per-second",i);break;case"ocean_current_kn":a=M(e,b,"knots",i)}return a}const C=[];function P(e,t){let i=0,s=0;const{width:r,height:a,mask:n}=e,o=e.pixels[0],l=[],h=[],c="wind_speed"===t.style?5:Number.MAX_VALUE;for(let e=0;e<a;e++)for(let t=0;t<r;t++){const u=e*r+t;if((!n||n[e*r+t])&&o[u]<c){for(let s=0;s<4;s++)l[i++]=(t+.5)/r,l[i++]=(e+.5)/a,l[i++]=s<2?-.5:.5,l[i++]=s%2==0?-.5:.5,l[i++]=0,l[i++]=o[u];const n=4*(i/24-1);h[s++]=n,h[s++]=n+1,h[s++]=n+2,h[s++]=n+1,h[s++]=n+2,h[s++]=n+3}}return{vertexData:new Float32Array(l),indexData:new Uint32Array(h)}}function k(e,t){return"simple_scalar"===t.style?P(e,t):"wind_speed"===t.style?function(e,t){if(0===C.length)for(let e=0;e<30;e++)C.push(y(5*e,0));const i=c(h.fromJSON(t.inputUnit),"knots"),{width:s,height:r,mask:a}=e,n=e.pixels[0],o=e.pixels[1],l=[],u=[];let p=0,d=0;for(let e=0;e<r;e++)for(let t=0;t<s;t++){const h=e*s+t,c=n[h]*i;if((!a||a[e*s+t])&&c>=5){var x;const i=null!=(x=(o[h]+360)%360/180*Math.PI)?x:2*Math.PI*Math.random(),{pennants:a,barbs:n,shaft:m}=C[Math.min(Math.floor(c/5),29)];if(a.length+n.length===0)continue;let f=l.length/6;const g=(t+.5)/s,y=(e+.5)/r;for(let e=0;e<a.length;e+=2)l[p++]=g,l[p++]=y,l[p++]=a[e],l[p++]=a[e+1]+i,l[p++]=0,l[p++]=c;for(let e=0;e<n.length;e+=2)l[p++]=g,l[p++]=y,l[p++]=n[e],l[p++]=n[e+1]+i,l[p++]=0,l[p++]=c;for(let e=0;e<m.length;e+=2)l[p++]=g,l[p++]=y,l[p++]=m[e],l[p++]=m[e+1]+i,l[p++]=0,l[p++]=c;for(let e=0;e<a.length/6;e++)u[d++]=f,u[d++]=f+1,u[d++]=f+2,f+=3;for(let e=0;e<n.length/8;e++)u[d++]=f,u[d++]=f+1,u[d++]=f+2,u[d++]=f+1,u[d++]=f+2,u[d++]=f+3,f+=4;u[d++]=f+0,u[d++]=f+1,u[d++]=f+2,u[d++]=f+1,u[d++]=f+3,u[d++]=f+2,f+=4}}return{vertexData:new Float32Array(l),indexData:new Uint32Array(u)}}(e,t):function(e,t){const{style:i,inputUnit:s,outputUnit:r,breakValues:a}=t,n=h.fromJSON(s),o=h.fromJSON(r);let l=0,c=0;const{width:u,height:p,mask:d}=e,x=e.pixels[0],m=e.pixels[1],f=d?d.filter((e=>e>0)).length:u*p,y=new Float32Array(42*f),w=new Uint32Array(15*f);for(let e=0;e<p;e++)for(let t=0;t<u;t++){const s=e*u+t;if(!d||d[e*u+t]){var v;const r=null!=(v=(m[s]+360)%360/180*Math.PI)?v:2*Math.PI*Math.random(),h=R(x[s],i,n,o,a);for(let i=0;i<g.length;i+=2)y[l++]=(t+.5)/u,y[l++]=(e+.5)/p,y[l++]=g[i],y[l++]=g[i+1]+r,y[l++]=h,y[l++]=x[s];const d=7*(l/42-1);w[c++]=d,w[c++]=d+1,w[c++]=d+2,w[c++]=d+0,w[c++]=d+4,w[c++]=d+3,w[c++]=d+0,w[c++]=d+2,w[c++]=d+3,w[c++]=d+2,w[c++]=d+5,w[c++]=d+3,w[c++]=d+5,w[c++]=d+6,w[c++]=d+3}}return{vertexData:y,indexData:w}}(e,t)}function I(e,t,i,s=[0,0],r=.5){const{width:n,height:o,mask:l}=e,[h,c]=e.pixels,[u,x]=s,m=Math.round((n-u)/i),f=Math.round((o-x)/i),g=m*f,y=new Float32Array(g),w=new Float32Array(g),v=new Uint8Array(g),_="vector-uv"===t;for(let e=0;e<f;e++)for(let t=0;t<m;t++){let s=0;const a=e*m+t,f=Math.max(0,e*i+x),g=Math.max(0,t*i+u),b=Math.min(o,f+i),M=Math.min(n,g+i);for(let e=f;e<b;e++)for(let t=g;t<M;t++){const i=e*n+t;if(!l||l[i]){s++;const e=_?[h[i],c[i]]:[h[i],(360+c[i])%360],[t,r]=_?e:d(e);y[a]+=t,w[a]+=r}}if(s>=(b-f)*(M-g)*(1-r)){v[a]=1;const[e,t]=p([y[a]/s,w[a]/s]);y[a]=e,w[a]=t}else v[a]=0,y[a]=0,w[a]=0}const b=new a.Z({width:m,height:f,pixels:[y,w],mask:v});return b.updateStatistics(),b}},86602:(e,t,i)=>{i.d(t,{eY:()=>u});var s=i(61681),r=i(1662),a=i(19710),n=i(55542),o=(i(78951),i(18567),i(39994),i(6174),i(91907),i(88338),i(17346),i(43487)),l=(i(29620),i(51118)),h=i(7349);function c(e,t,i){const s={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};return t&&i&&(s.width=t,s.height=i),new o.Z(e,s)}class u extends l.s{constructor(e=null,t,i=!0){super(),this.requestRenderOnSourceChangedEnabled=i,this._textureInvalidated=!0,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._width=void 0,this.x=0,this.y=0,this.blendFunction=t,this.source=e,this.requestRender=this.requestRender.bind(this)}destroy(){this._texture&&(this._texture.dispose(),this._texture=null)}get isSourceScaled(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}get height(){return void 0!==this._height?this._height:this.sourceHeight}set height(e){this._height=e}get source(){return this._source}set source(e){this._source=e,this.invalidateTexture()}get sourceHeight(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}get sourceWidth(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width}get width(){return void 0!==this._width?this._width:this.sourceWidth}set width(e){this._width=e}beforeRender(e){super.beforeRender(e),this.updateTexture(e.context)}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())}_createTransforms(){return{dvs:(0,a.c)()}}setTransform(e){const t=(0,r.b)(this.transforms.dvs),[i,s]=e.toScreenNoRotation([0,0],[this.x,this.y]),a=this.resolution/this.pixelRatio/e.resolution,o=a*this.width,l=a*this.height,h=Math.PI*this.rotation/180;(0,r.c)(t,t,(0,n.f)(i,s)),(0,r.c)(t,t,(0,n.f)(o/2,l/2)),(0,r.r)(t,t,-h),(0,r.c)(t,t,(0,n.f)(-o/2,-l/2)),(0,r.j)(t,t,(0,n.f)(o,l)),(0,r.m)(this.transforms.dvs,e.displayViewMat3,t)}setSamplingProfile(e){this._texture&&(e.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(e.samplingMode))}bind(e,t){this._texture&&e.bindTexture(this._texture,t)}updateTexture(e){var t;if(!this.stage)return null==(t=this._texture)||t.dispose(),void(this._texture=null);if(!this._textureInvalidated)return;this._textureInvalidated=!1,this._texture||(this.source?this._texture=c(e,this.sourceWidth,this.sourceHeight):this._texture=c(e));const i=this.source;if(i){if(this._texture.resize(this.sourceWidth,this.sourceHeight),(r=i)&&"render"in r)if(i instanceof h.Z){const e=i.getRenderedRasterPixels();this._texture.setData((0,s.pC)(e)?e.renderedRasterPixels:null)}else this._texture.setData(function(e){const t=document.createElement("canvas");return t.width=e.width,t.height=e.height,e.render(t.getContext("2d")),t}(i));else(function(e){return e&&!("render"in e)})(i)&&this._texture.setData(i);this.ready()}else this._texture.setData(null);var r}onAttach(){this.invalidateTexture()}onDetach(){this.invalidateTexture()}}},12688:(e,t,i)=>{i.d(t,{c:()=>n});var s=i(14351),r=i(38716),a=i(10994);class n extends a.Z{get requiresDedicatedFBO(){return this.children.some((e=>"additive"===e.blendFunction))}prepareRenderPasses(e){const t=e.registerRenderPass({name:"bitmap",brushes:[s.U.bitmap],target:()=>this.children,drawPhase:r.jx.MAP});return[...super.prepareRenderPasses(e),t]}}},7349:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(61681);class r{constructor(e,t,i){this.pixelBlock=e,this.extent=t,this.originalPixelBlock=i}get width(){return(0,s.pC)(this.pixelBlock)?this.pixelBlock.width:0}get height(){return(0,s.pC)(this.pixelBlock)?this.pixelBlock.height:0}render(e){const t=this.pixelBlock;if((0,s.Wi)(t))return;const i=this.filter({pixelBlock:t});if((0,s.Wi)(i.pixelBlock))return;const r=i.pixelBlock.getAsRGBA(),a=e.createImageData(i.pixelBlock.width,i.pixelBlock.height);a.data.set(r),e.putImageData(a,0,0)}getRenderedRasterPixels(){const e=this.filter({pixelBlock:this.pixelBlock});return(0,s.Wi)(e.pixelBlock)?null:{width:e.pixelBlock.width,height:e.pixelBlock.height,renderedRasterPixels:new Uint8Array(e.pixelBlock.getAsRGBA().buffer)}}}},90890:(e,t,i)=>{i.r(t),i.d(t,{default:()=>z});var s=i(36663),r=i(15071),a=i(81977),n=(i(39994),i(7283),i(13802)),o=i(12571),l=i(80347),h=i(80085),c=i(66341),u=i(23657),p=i(61681),d=i(78668),x=i(95550),m=i(79438),f=i(91772),g=i(18486),y=i(7928),w=i(94449),v=i(10530),_=i(68114),b=i(57971);const M=n.Z.getLogger("esri.views.2d.layers.imagery.ImageryGraphicsView2D");let R=class extends u.Z{constructor(){super(...arguments),this.attached=!1,this.container=new v.W,this.updateRequested=!1,this._graphicsView=null,this._projectFullExtentPromise=null,this._dataParameters={exportParametersVersion:0,extents:[],tileResolution:0,time:""},this.type="Graphics",this._graphics=new w.ZP,this._updateGraphics=(0,d.Ds)((async(e,t)=>{if(!e.stationary)return;const i=e.state,s=new f.Z({xmin:i.extent.xmin,ymin:i.extent.ymin,xmax:i.extent.xmax,ymax:i.extent.ymax,spatialReference:i.spatialReference}),[r,a]=e.state.size,n={};n.timeExtent=this.timeExtent,n.requestAsImageElement=!1,n.signal=t,null==this._projectFullExtentPromise&&(this._projectFullExtentPromise=this._getProjectedFullExtent(s.spatialReference));const o="vector-field"===this.layer.renderer.type?this.layer.renderer.symbolTileSize:50,l=await this._projectFullExtentPromise,{extent:h,resolution:c,width:u,height:d}=(0,y.BH)(s,r,a,o,l),x=await this.layer.fetchImage(h,u,d,n),m=this.layer.renderer;if("vector-field"===m.type){const t=x.pixelData.pixelBlock,i=m.sizeVariables[0];!(0,p.pC)(t)||i.minDataValue&&i.maxDataValue||(i.minDataValue=t.statistics[0].minValue,i.maxDataValue=t.statistics[0].maxValue),this._pixelData={extent:h,pixelBlock:t};const s=h.clone().normalize(),r={exportParametersVersion:this.layer.exportImageServiceParameters.version,extents:s,tileResolution:c,time:JSON.stringify(this.timeExtent||"")},a=this._canReuseVectorFieldData(r)?this._dataParameters.extents:[],n=await m.getGraphicsFromPixelData(x.pixelData,"vector-uv"===this.layer.rasterInfo.dataType,a);if(a.length){const e=this._graphics.items.filter((e=>(0,p.pC)(e.geometry)&&a.some((t=>t.intersects(e.geometry)))&&!s.some((t=>t.intersects(e.geometry)))));this._graphics.removeMany(e),this._graphics.addMany(n)}else this._graphics.set("items",n);this._graphicsView.update(e),this._dataParameters=r}}))}destroy(){this.attached&&(this.detach(),this.attached=!1),this.updateRequested=!1}get updating(){return!this.attached||this.isUpdating()}update(e){this._updateGraphics(e).catch((e=>{(0,d.D_)(e)||M.error(e)}))}hitTest(e,t){const i=this.view.toMap((0,x.vW)(e,t));return Promise.resolve(new h.Z({attributes:{},geometry:i,layer:this.layer}))}attach(){this._graphicsView=new b.Z({view:this.view,graphics:this._graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new _.Z(this.view.featuresTilingScheme)}),this.attached=!0}detach(){this._graphics.destroy(),this._graphicsView.destroy(),this.container.removeChild(this._graphicsView.container),this._graphicsView=null}install(e){this.container.addChild(this._graphicsView.container),e.addChild(this.container)}uninstall(e){this.container.removeChild(this._graphicsView.container),e.removeChild(this.container)}isUpdating(){return this._graphicsView.updating||this.updateRequested}getPixelData(){return this.updating?null:this._pixelData}redraw(){}requestUpdate(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())}async _getProjectedFullExtent(e){try{return await(0,g.tB)(this.layer.fullExtent,e)}catch(t){try{const t=(await(0,c.default)(this.layer.url,{query:{option:"footprints",outSR:e.wkid||JSON.stringify(e.toJSON()),f:"json"}})).data.featureCollection.layers[0].layerDefinition.extent;return t?f.Z.fromJSON(t):null}catch{return null}}}_canReuseVectorFieldData(e){const t=this._dataParameters.exportParametersVersion===e.exportParametersVersion,i=this._dataParameters.time===e.time,s=Math.abs(this._dataParameters.tileResolution-e.tileResolution)/e.tileResolution<.01,r=this._dataParameters.extents.some((t=>e.extents.some((e=>t.intersects(e)))));return t&&i&&s&&r}};(0,s._)([(0,a.Cb)()],R.prototype,"attached",void 0),(0,s._)([(0,a.Cb)()],R.prototype,"container",void 0),(0,s._)([(0,a.Cb)()],R.prototype,"layer",void 0),(0,s._)([(0,a.Cb)()],R.prototype,"timeExtent",void 0),(0,s._)([(0,a.Cb)()],R.prototype,"view",void 0),(0,s._)([(0,a.Cb)()],R.prototype,"updateRequested",void 0),(0,s._)([(0,a.Cb)()],R.prototype,"updating",null),(0,s._)([(0,m.J)({graphics:"Graphics"})],R.prototype,"type",void 0),R=(0,s._)([(0,o.j)("esri.views.2d.layers.imagery.ImageryGraphicsView2D")],R);var C=R,P=i(31329),k=i(12688),I=i(7349),S=i(23134);const V=n.Z.getLogger("esri.views.2d.layers.imagery.ImageryView2D");let E=class extends u.Z{constructor(){super(...arguments),this.attached=!1,this.container=new v.W,this.updateRequested=!1,this.type="Imagery",this._bitmapView=null}destroy(){this.attached&&(this.detach(),this.attached=!1),this.updateRequested=!1}get updating(){return!this.attached||this.isUpdating()}update(e){this.strategy.update(e).catch((e=>{(0,d.D_)(e)||V.error(e)}))}detach(){this.strategy.destroy(),this._bitmapView.removeAllChildren(),this.container.removeAllChildren()}hitTest(e,t){const i=this.view.toMap((0,x.vW)(e,t));return Promise.resolve(new h.Z({attributes:{},geometry:i,layer:this.layer}))}attach(){const e=this.layer.version>=10,t=this.layer.version>=10.1?this.layer.imageMaxHeight:2048,i=this.layer.version>=10.1?this.layer.imageMaxWidth:2048;this._bitmapView=new k.c,this.strategy=new S.Z({container:this._bitmapView,imageNormalizationSupported:e,imageMaxHeight:t,imageMaxWidth:i,fetchSource:this._fetchImage.bind(this),requestUpdate:()=>this.requestUpdate()}),this.attached=!0}install(e){this.container.addChild(this._bitmapView),e.addChild(this.container)}uninstall(e){this.container.removeChild(this._bitmapView),e.removeChild(this.container)}redraw(){this.strategy.updateExports((e=>{e.source instanceof HTMLImageElement?e.requestRender():this.layer.applyRenderer({pixelBlock:e.source.pixelBlock}).then((t=>{const i=e.source;i.pixelBlock=t.pixelBlock,i.filter=e=>this.layer.applyFilter(e),this.container.requestRender()}))}))}requestUpdate(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())}isUpdating(){return this.strategy.updating||this.updateRequested}getPixelData(){if(this.updating)return null;const e=this.strategy.bitmaps;if(1===e.length&&e[0].source)return{extent:e[0].source.extent,pixelBlock:e[0].source.originalPixelBlock};if(e.length>1){const t=this.view.extent,i=e.map((e=>e.source)).filter((e=>e.extent&&e.extent.intersects(t))).map((e=>({extent:e.extent,pixelBlock:e.originalPixelBlock}))),s=(0,P.Kh)(i,t);return(0,p.pC)(s)?{extent:s.extent,pixelBlock:s.pixelBlock}:null}return null}_fetchImage(e,t,i,s){return(s=s||{}).timeExtent=this.timeExtent,s.requestAsImageElement=!0,this.layer.fetchImage(e,t,i,s).then((e=>e.imageElement?e.imageElement:this.layer.applyRenderer(e.pixelData,{signal:s.signal}).then((t=>{const i=new I.Z(t.pixelBlock,t.extent.clone(),e.pixelData.pixelBlock);return i.filter=e=>this.layer.applyFilter(e),i}))))}};(0,s._)([(0,a.Cb)()],E.prototype,"attached",void 0),(0,s._)([(0,a.Cb)()],E.prototype,"container",void 0),(0,s._)([(0,a.Cb)()],E.prototype,"layer",void 0),(0,s._)([(0,a.Cb)()],E.prototype,"strategy",void 0),(0,s._)([(0,a.Cb)()],E.prototype,"timeExtent",void 0),(0,s._)([(0,a.Cb)()],E.prototype,"view",void 0),(0,s._)([(0,a.Cb)()],E.prototype,"updateRequested",void 0),(0,s._)([(0,a.Cb)()],E.prototype,"updating",null),(0,s._)([(0,m.J)({imagery:"Imagery"})],E.prototype,"type",void 0),E=(0,s._)([(0,o.j)("esri.views.2d.layers.imagery.ImageryView2D")],E);var Z=E,q=i(70375),D=i(53446),T=i(51599),B=i(14136),F=i(59439);const W=e=>{let t=class extends e{constructor(){super(...arguments),this.view=null}async fetchPopupFeatures(e,t){const{layer:i}=this;if(!e)throw new q.Z("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:i});const{popupEnabled:s}=i,r=(0,F.V)(i,t);if(!s||!(0,p.pC)(r))throw new q.Z("imagerylayerview:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:s,popupTemplate:r});const a=await r.getRequiredFields(),n=new B.Z;n.timeExtent=this.timeExtent,n.geometry=e,n.outFields=a,n.outSpatialReference=e.spatialReference;const o=this.view.resolution,l="2d"===this.view.type?new D.Z(o,o,this.view.spatialReference):new D.Z(.5*o,.5*o,this.view.spatialReference),{returnTopmostRaster:h,showNoDataRecords:c}=r.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},u={returnDomainValues:!0,returnTopmostRaster:h,pixelSize:l,showNoDataRecords:c,signal:(0,p.pC)(t)?t.signal:null};return i.queryVisibleRasters(n,u).then((e=>e))}canResume(){var e;return!(!super.canResume()||null!=(e=this.timeExtent)&&e.isEmpty)}};return(0,s._)([(0,a.Cb)()],t.prototype,"layer",void 0),(0,s._)([(0,a.Cb)()],t.prototype,"suspended",void 0),(0,s._)([(0,a.Cb)(T.qG)],t.prototype,"timeExtent",void 0),(0,s._)([(0,a.Cb)()],t.prototype,"view",void 0),t=(0,s._)([(0,o.j)("esri.views.layers.ImageryLayerView")],t),t};var j=i(26216),U=i(55068);let N=class extends(W((0,U.y)((0,l.y)(j.Z)))){constructor(){super(...arguments),this._exportImageVersion=-1}initialize(){this.handles.add([(0,r.S1)(this,["layer.blendMode","layer.effects"],(e=>{this.subview&&(this.subview.container.blendMode=e)}),!0),(0,r.S1)(this,["layer.effect"],(e=>{this.subview&&(this.subview.container.effect=e)}),!0)])}get pixelData(){return this.updating?null:this.subview.getPixelData()}get updating(){return!(this.subview&&!this.subview.updating)}hitTest(e,t){return this.suspended||!this.subview?Promise.resolve(null):this.subview.hitTest(e,t)}update(e){var t;null==(t=this.subview)||t.update(e)}attach(){this.layer.increaseRasterJobHandlerUsage(),this._setSubView(),this.handles.add([(0,r.S1)(this,"layer.exportImageServiceParameters.version",(e=>{this._exportImageVersion!==e&&(this._exportImageVersion=e,this.requestUpdate())})),this.watch("timeExtent",(()=>{this.subview.timeExtent=this.timeExtent,this.requestUpdate()})),this.layer.on("redraw",(()=>this.subview.redraw())),(0,r.YP)(this.layer,"renderer",(()=>this._setSubView()))],"imagerylayerview-update")}detach(){this.layer.decreaseRasterJobHandlerUsage(),this.subview.destroy(),this.handles.remove("imagerylayerview-update"),this._exportImageVersion=-1}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}async doRefresh(){this.requestUpdate()}isUpdating(){return!this.subview||!this.suspended&&this.subview.isUpdating()}_setSubView(){var e;let t="Imagery";var i,s;"vector-field"===(null==(e=this.layer.renderer)?void 0:e.type)&&"lerc"===this.layer.format&&(t="Graphics"),this.subview&&this.subview.type===t||(null==(i=this.subview)||i.uninstall(this.container),null==(s=this.subview)||s.destroy(),this.subview="Imagery"===t?new Z({layer:this.layer,view:this.view,timeExtent:this.timeExtent}):new C({layer:this.layer,view:this.view,timeExtent:this.timeExtent}),this.subview.attach(),this.subview.install(this.container),this.subview.container.blendMode=this.layer.blendMode,this.subview.container.effect=this.layer.effect),this.requestUpdate()}};(0,s._)([(0,a.Cb)()],N.prototype,"pixelData",null),(0,s._)([(0,a.Cb)({readOnly:!0})],N.prototype,"updating",null),(0,s._)([(0,a.Cb)()],N.prototype,"subview",void 0),N=(0,s._)([(0,o.j)("esri.views.2d.layers.ImageryLayerView2D")],N);var z=N},68114:(e,t,i)=>{i.d(t,{Z:()=>a});var s=i(38716),r=i(28715);class a extends r.Z{renderChildren(e){this.attributeView.bindTextures(e.context,!1),this.children.some((e=>e.hasData))&&(super.renderChildren(e),e.drawPhase===s.jx.MAP&&this._renderChildren(e),this.hasHighlight()&&e.drawPhase===s.jx.HIGHLIGHT&&this._renderHighlight(e))}_renderHighlight(e){const{painter:t}=e,i=t.effects.highlight;i.bind(e),this._renderChildren(e,i.defines),i.draw(e),i.unbind()}}},23134:(e,t,i)=>{i.d(t,{Z:()=>b});var s=i(36663),r=i(23657),a=i(78668),n=i(81977),o=(i(39994),i(7283),i(13802),i(12571)),l=i(91772),h=i(24568),c=i(35925),u=i(81590);const p=Math.PI/180;function d(e){return e*p}function x(e,t){const i=d(t.rotation),s=Math.abs(Math.cos(i)),r=Math.abs(Math.sin(i)),[a,n]=t.size;return e[0]=Math.round(n*r+a*s),e[1]=Math.round(n*s+a*r),e}var m=i(86602),f=i(64970),g=i(87241);const y=(0,h.Ue)(),w=[0,0],v=new g.Z(0,0,0,0);let _=class extends r.Z{constructor(e){super(e),this._imagePromise=null,this.bitmaps=[],this.hidpi=false,this.imageMaxWidth=2048,this.imageMaxHeight=2048,this.imageRotationSupported=false,this.imageNormalizationSupported=false,this.update=(0,a.Ds)((async(e,t)=>{if(!e.stationary||this.destroyed)return null;const i=e.state,s=(0,c.C5)(i.spatialReference),r=this.hidpi?e.pixelRatio:1,a=this.imageNormalizationSupported&&i.worldScreenWidth&&i.worldScreenWidth<i.size[0];a?(w[0]=i.worldScreenWidth,w[1]=i.size[1]):this.imageRotationSupported?(w[0]=i.size[0],w[1]=i.size[1]):x(w,i);const n=Math.floor(w[0]*r)>this.imageMaxWidth||Math.floor(w[1]*r)>this.imageMaxHeight,o=s&&(i.extent.xmin<s.valid[0]||i.extent.xmax>s.valid[1]),l=!this.imageNormalizationSupported&&o,h=!n&&!l,u=this.imageRotationSupported?i.rotation:0;if(h){const e=a?i.paddedViewState.center:i.center;this._imagePromise=this._singleExport(i,w,e,i.resolution,u,r,t)}else{let e=Math.min(this.imageMaxWidth,this.imageMaxHeight);l&&(e=Math.min(i.worldScreenWidth,e)),this._imagePromise=this._tiledExport(i,e,u,r,t)}return this._imagePromise.then((async e=>{if(this._imagePromise=null,!this.destroyed){this.bitmaps=null!=e?e:[];for(const t of this.container.children)e.includes(t)||t.fadeOut().then((()=>{t.remove()}));for(const t of e)this.container.addChild(t),t.fadeIn()}})).catch((e=>{throw this._imagePromise=null,e}))}),5e3)}destroy(){this.bitmaps=[]}get updating(){return!this.destroyed&&null!==this._imagePromise}updateExports(e){for(const t of this.container.children){if(!t.visible||!t.stage)return;e(t),t.invalidateTexture(),t.requestRender()}}async _export(e,t,i,s,r,a){const n=await this.fetchSource(e,Math.floor(t*r),Math.floor(i*r),{rotation:s,pixelRatio:r,signal:a}),o=new m.eY(n,"additive");return o.x=e.xmin,o.y=e.ymax,o.resolution=e.width/t,o.rotation=s,o.pixelRatio=r,o}async _singleExport(e,t,i,s,r,a,n){!function(e,t,i,s){const[r,a]=t,[n,o]=s,l=.5*i;e[0]=r-l*n,e[1]=a-l*o,e[2]=r+l*n,e[3]=a+l*o}(y,i,s,t);const o=new l.Z(y[0],y[1],y[2],y[3],e.spatialReference);return[await this._export(o,t[0],t[1],r,a,n)]}_tiledExport(e,t,i,s,r){const a=u.Z.create({size:t,spatialReference:e.spatialReference,scales:[e.scale]}),n=new f.Z(a),o=n.getTileCoverage(e);if(!o)return null;const h=[];return o.forEach(((a,o,c,u)=>{v.set(a,o,c,u),n.getTileBounds(y,v);const p=new l.Z(y[0],y[1],y[2],y[3],e.spatialReference);h.push(this._export(p,t,t,i,s,r))})),Promise.all(h)}};(0,s._)([(0,n.Cb)()],_.prototype,"_imagePromise",void 0),(0,s._)([(0,n.Cb)()],_.prototype,"bitmaps",void 0),(0,s._)([(0,n.Cb)()],_.prototype,"container",void 0),(0,s._)([(0,n.Cb)()],_.prototype,"fetchSource",void 0),(0,s._)([(0,n.Cb)()],_.prototype,"hidpi",void 0),(0,s._)([(0,n.Cb)()],_.prototype,"imageMaxWidth",void 0),(0,s._)([(0,n.Cb)()],_.prototype,"imageMaxHeight",void 0),(0,s._)([(0,n.Cb)()],_.prototype,"imageRotationSupported",void 0),(0,s._)([(0,n.Cb)()],_.prototype,"imageNormalizationSupported",void 0),(0,s._)([(0,n.Cb)()],_.prototype,"requestUpdate",void 0),(0,s._)([(0,n.Cb)()],_.prototype,"updating",null),_=(0,s._)([(0,o.j)("esri.views.2d.layers.support.ExportStrategy")],_);var b=_},55068:(e,t,i)=>{i.d(t,{y:()=>h});var s=i(36663),r=i(13802),a=i(78668),n=i(15071),o=i(81977),l=(i(39994),i(7283),i(12571));const h=e=>{let t=class extends e{initialize(){this.handles.add((0,n.on)(this,"layer","refresh",(()=>{this.doRefresh().catch((e=>{(0,a.D_)(e)||r.Z.getLogger(this.declaredClass).error(e)}))})),"RefreshableLayerView")}};return(0,s._)([(0,o.Cb)()],t.prototype,"layer",void 0),t=(0,s._)([(0,l.j)("esri.layers.mixins.RefreshableLayerView")],t),t}},59439:(e,t,i)=>{i.d(t,{V:()=>n,e:()=>a});var s=i(61681),r=i(17095);async function a(e,t=e.popupTemplate){if(!(0,s.pC)(t))return[];const i=await t.getRequiredFields(e.fieldsIndex),{lastEditInfoEnabled:a}=t,{objectIdField:n,typeIdField:o,globalIdField:l,relationships:h}=e;if(i.includes("*"))return["*"];const c=a?await(0,r.CH)(e):[],u=(0,r.Q0)(e.fieldsIndex,[...i,...c]);return o&&u.push(o),u&&n&&e.fieldsIndex.has(n)&&-1===u.indexOf(n)&&u.push(n),u&&l&&e.fieldsIndex.has(l)&&-1===u.indexOf(l)&&u.push(l),h&&h.forEach((t=>{const{keyField:i}=t;u&&i&&e.fieldsIndex.has(i)&&-1===u.indexOf(i)&&u.push(i)})),u}function n(e,t){return e.popupTemplate?e.popupTemplate:(0,s.pC)(t)&&t.defaultPopupTemplateEnabled&&(0,s.pC)(e.defaultPopupTemplate)?e.defaultPopupTemplate:null}}}]);